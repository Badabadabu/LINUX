# MySQL задачи с базой данных HR - Пошаговые решения

## Основы SQL запросов

**Структура базового SELECT запроса:**
```sql
SELECT столбцы
FROM таблица
WHERE условие;
```

## Задача 1: Найти всех сотрудников в департаменте с id 90

### Решение:
```sql
SELECT *
FROM employees
WHERE department_id = 90;
```

### Пошаговое объяснение:
1. **SELECT \*** - выбираем ВСЕ столбцы (звездочка означает "все поля")
2. **FROM employees** - из таблицы employees
3. **WHERE department_id = 90** - условие: только те записи, где department_id равен 90

### Ключевые понятия:
- **WHERE** - ключевое слово для фильтрации данных
- **=** - оператор равенства (точное совпадение)
- **department_id** - название столбца с ID департамента

### Альтернативное решение (если нужны только определенные поля):
```sql
SELECT employee_id, first_name, last_name, salary
FROM employees
WHERE department_id = 90;
```

---

## Задача 2: Найти всех сотрудников, зарабатывающих больше 5000

### Решение:
```sql
SELECT *
FROM employees
WHERE salary > 5000;
```

### Пошаговое объяснение:
1. **SELECT \*** - выбираем все столбцы
2. **FROM employees** - из таблицы сотрудников
3. **WHERE salary > 5000** - условие: зарплата больше 5000

### Ключевые понятия:
- **>** - оператор "больше чем"
- **salary** - столбец с зарплатой
- Сравнение с числовым значением (без кавычек)

### Дополнительные операторы сравнения:
- **>=** - больше или равно
- **<** - меньше
- **<=** - меньше или равно
- **!=** или **<>** - не равно

---

## Задача 3: Найти всех сотрудников, чья фамилия начинается на букву L

### Решение:
```sql
SELECT *
FROM employees
WHERE last_name LIKE 'L%';
```

### Пошаговое объяснение:
1. **SELECT \*** - выбираем все столбцы
2. **FROM employees** - из таблицы сотрудников
3. **WHERE last_name LIKE 'L%'** - условие: фамилия начинается с L

### Ключевые понятия:
- **LIKE** - оператор для поиска по шаблону
- **'L%'** - шаблон поиска:
  - **L** - буква L (обязательна в начале)
  - **%** - любое количество любых символов после L
- Текстовые значения всегда в одинарных кавычках

### Другие примеры с LIKE:
```sql
-- Фамилия заканчивается на 'son'
WHERE last_name LIKE '%son'

-- Фамилия содержит 'and'
WHERE last_name LIKE '%and%'

-- Второя буква 'a'
WHERE last_name LIKE '_a%'
```

---

## Задача 4: Вывести зарплату сотрудника с именем 'Lex' и фамилией 'De Haan'

### Решение:
```sql
SELECT salary
FROM employees
WHERE first_name = 'Lex' AND last_name = 'De Haan';
```

### Пошаговое объяснение:
1. **SELECT salary** - выбираем только столбец зарплаты
2. **FROM employees** - из таблицы сотрудников
3. **WHERE first_name = 'Lex' AND last_name = 'De Haan'** - два условия одновременно

### Ключевые понятия:
- **AND** - логический оператор "И" (оба условия должны быть истинными)
- **=** - точное совпадение для текста
- Регистр важен! 'Lex' ≠ 'lex'

### Логические операторы:
- **AND** - оба условия истинны
- **OR** - хотя бы одно условие истинно
- **NOT** - отрицание

### Альтернативное решение (с дополнительной информацией):
```sql
SELECT first_name, last_name, salary
FROM employees
WHERE first_name = 'Lex' AND last_name = 'De Haan';
```

---

## Задача 5: Создать поле SALARY_GROUP (1 если зп > 10000, иначе 0)

### Решение:
```sql
SELECT 
    employee_id,
    first_name,
    last_name,
    salary,
    CASE 
        WHEN salary > 10000 THEN 1
        ELSE 0
    END AS SALARY_GROUP
FROM employees;
```

### Пошаговое объяснение:
1. **SELECT** - выбираем несколько столбцов
2. **CASE WHEN ... THEN ... ELSE ... END** - условная конструкция
3. **WHEN salary > 10000 THEN 1** - если зарплата больше 10000, то вернуть 1
4. **ELSE 0** - иначе вернуть 0
5. **AS SALARY_GROUP** - назвать новый столбец SALARY_GROUP

### Ключевые понятия:
- **CASE** - аналог if-else в программировании
- **AS** - псевдоним (алиас) для столбца
- **THEN** - "то" (результат условия)
- **ELSE** - "иначе" (альтернативный результат)
- **END** - завершение конструкции CASE

### Альтернативное решение (более простое):
```sql
SELECT 
    *,
    IF(salary > 10000, 1, 0) AS SALARY_GROUP
FROM employees;
```

### Расширенный пример с несколькими условиями:
```sql
SELECT 
    first_name,
    last_name,
    salary,
    CASE 
        WHEN salary > 15000 THEN 'Высокая'
        WHEN salary > 10000 THEN 'Средняя'
        WHEN salary > 5000 THEN 'Низкая'
        ELSE 'Очень низкая'
    END AS SALARY_CATEGORY
FROM employees;
```

---

## Задача 6: Найти среднюю зарплату сотрудников, зарабатывающих меньше 10000

### Решение:
```sql
SELECT AVG(salary) AS average_salary
FROM employees
WHERE salary < 10000;
```

### Пошаговое объяснение:
1. **SELECT AVG(salary)** - вычисляем среднее значение столбца salary
2. **AS average_salary** - даем псевдоним результату
3. **FROM employees** - из таблицы сотрудников
4. **WHERE salary < 10000** - только для тех, кто зарабатывает меньше 10000

### Ключевые понятия:
- **AVG()** - агрегатная функция для вычисления среднего
- Сначала применяется WHERE (фильтрация), потом AVG (вычисление)
- Результат - одно число (средняя зарплата)

### Другие агрегатные функции:
```sql
-- Количество сотрудников
SELECT COUNT(*) FROM employees WHERE salary < 10000;

-- Максимальная зарплата
SELECT MAX(salary) FROM employees WHERE salary < 10000;

-- Минимальная зарплата
SELECT MIN(salary) FROM employees WHERE salary < 10000;

-- Сумма всех зарплат
SELECT SUM(salary) FROM employees WHERE salary < 10000;
```

### Расширенный пример с форматированием:
```sql
SELECT 
    COUNT(*) AS количество_сотрудников,
    AVG(salary) AS средняя_зарплата,
    MIN(salary) AS минимальная_зарплата,
    MAX(salary) AS максимальная_зарплата
FROM employees
WHERE salary < 10000;
```

---

## Практические советы для новичков

### 1. Порядок выполнения SQL запроса:
1. **FROM** - определение таблицы
2. **WHERE** - фильтрация строк
3. **SELECT** - выбор столбцов
4. **ORDER BY** - сортировка (если есть)

### 2. Частые ошибки:
- Забывать кавычки для текстовых значений
- Путать = и LIKE
- Неправильный порядок ключевых слов

### 3. Полезные команды для изучения структуры:
```sql
-- Посмотреть структуру таблицы
DESCRIBE employees;

-- Посмотреть первые 5 записей
SELECT * FROM employees LIMIT 5;

-- Посмотреть уникальные значения департаментов
SELECT DISTINCT department_id FROM employees;
```

### 4. Советы по форматированию:
- Ключевые слова пишите ЗАГЛАВНЫМИ буквами
- Каждое ключевое слово с новой строки
- Используйте отступы для читаемости

### 5. Тестирование запросов:
- Начинайте с простых запросов
- Добавляйте LIMIT для больших таблиц
- Проверяйте результаты на логичность